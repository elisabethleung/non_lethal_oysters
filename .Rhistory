family = "serif") +
scale_size_continuous(name = "Mean Gel Score\n(DNA Quality)",
range = c(3, 15),
limits = c(1, 4),
breaks = c(1, 2, 3, 4)) +
labs(x = "Mean Lifespan (days)",
y = "Mean DNA Concentration (total ng)",
title = "Oyster Survival vs DNA Yield and Quality by Treatment") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 12, hjust= 0.5),
legend.position = "right", text=element_text(family="serif"))
print(bubble_plot)
bubble_plot <- ggplot(combined_data, aes(x = mean_lifespan, y = mean_dna_conc,
size = mean_gel_score)) +
geom_point(alpha = 0.6, color = "steelblue") +
geom_text(aes(label = Overall_Trt), vjust = 4, hjust = 0.5, size = 3,
family = "serif") +
scale_size_continuous(name = "Mean Gel Score\n(DNA Quality)",
range = c(3, 15),
limits = c(1, 4),
breaks = c(1, 2, 3, 4)) +
labs(x = "Mean Lifespan (days)",
y = "Mean DNA Concentration (total ng)",
title = "Oyster Survival vs DNA Yield and Quality by Treatment") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 12, hjust= 0.5),
legend.position = "right", text=element_text(family="serif"))
bubble_plot
bubble_plot <- ggplot(combined_data, aes(x = mean_lifespan, y = mean_dna_conc,
size = mean_gel_score)) +
geom_point(alpha = 0.6, color = "steelblue") +
geom_text(aes(label = Overall_Trt), vjust = 4, hjust = 0.5, size = 3,
family = "serif") +
scale_size_continuous(name = "Mean Gel Score\n(DNA Quality)",
range = c(3, 15),
limits = c(1, 4),
breaks = c(1, 2, 3, 4)) +
labs(x = "Mean Lifespan (days)",
y = "Mean DNA Concentration (total ng)",
title = "Oyster Survival, DNA Quantity, and DNA Quality by Treatment") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 12, hjust= 0.5),
legend.position = "right", text=element_text(family="serif"))
bubble_plot
# Load required libraries
library(tidyverse)
dna_data_clean <- dna_publish %>%
filter(Overall_Trt != "#N/A" & !is.na(Overall_Trt)) %>%
mutate(dna_conc_ng_total = as.numeric(dna_conc_ng_total),
gel_score_numeric = as.numeric(str_extract(gel_score, "^\\d+")))
mortality_data_clean <- mortality_data_nofta %>%
filter(Overall_Trt != "#N/A" & !is.na(Overall_Trt)) %>%
mutate(lifespan = as.numeric(Lifespan_days))
mortality_summary <- mortality_data_clean %>%
group_by(Overall_Trt) %>%
summarise(
total_n = n(),
alive_at_end = sum(lifespan >= 11.5, na.rm = TRUE),
percent_alive = (alive_at_end / total_n) * 100,
se_percent = sqrt((percent_alive/100) * (1 - percent_alive/100) / total_n) * 100
)
dna_summary <- dna_data_clean %>%
group_by(Overall_Trt) %>%
summarise(mean_dna_conc = mean(dna_conc_ng_total, na.rm = TRUE),
se_dna_conc = sd(dna_conc_ng_total, na.rm = TRUE) / sqrt(n()),
mean_gel_score = mean(gel_score_numeric, na.rm = TRUE),
se_gel_score = sd(gel_score_numeric, na.rm = TRUE) / sqrt(n()))
combined_data <- left_join(mortality_summary, dna_summary, by = "Overall_Trt") %>%
filter(!is.na(mean_lifespan) & !is.na(mean_dna_conc) & !is.na(mean_gel_score))
# Load required libraries
library(tidyverse)
dna_data_clean <- dna_publish %>%
filter(Overall_Trt != "#N/A" & !is.na(Overall_Trt)) %>%
mutate(dna_conc_ng_total = as.numeric(dna_conc_ng_total),
gel_score_numeric = as.numeric(str_extract(gel_score, "^\\d+")))
mortality_data_clean <- mortality_data_nofta %>%
filter(Overall_Trt != "#N/A" & !is.na(Overall_Trt)) %>%
mutate(lifespan = as.numeric(Lifespan_days))
mortality_summary <- mortality_data_clean %>%
group_by(Overall_Trt) %>%
summarise(
total_n = n(),
alive_at_end = sum(lifespan >= 11.5, na.rm = TRUE),
percent_alive = (alive_at_end / total_n) * 100,
se_percent = sqrt((percent_alive/100) * (1 - percent_alive/100) / total_n) * 100
)
dna_summary <- dna_data_clean %>%
group_by(Overall_Trt) %>%
summarise(mean_dna_conc = mean(dna_conc_ng_total, na.rm = TRUE),
se_dna_conc = sd(dna_conc_ng_total, na.rm = TRUE) / sqrt(n()),
mean_gel_score = mean(gel_score_numeric, na.rm = TRUE),
se_gel_score = sd(gel_score_numeric, na.rm = TRUE) / sqrt(n()))
combined_data <- left_join(mortality_summary, dna_summary, by = "Overall_Trt") %>%
filter(!is.na(percent_alive) & !is.na(mean_dna_conc) & !is.na(mean_gel_score))
combined_data$Overall_Trt <- as.character(combined_data$Overall_Trt)
combined_data$Overall_Trt[combined_data$Overall_Trt == "Control_Control_Control"] <- "DNA_Control"
combined_data$Overall_Trt[combined_data$Overall_Trt == "RelaxEpsom_Mantle_Etoh"] <- "Relax_Mantle_EtOH"
combined_data$Overall_Trt[combined_data$Overall_Trt == "RelaxEpsom_Swab_FlashFreeze"] <- "Relax_Swab_Flash"
combined_data$Overall_Trt[combined_data$Overall_Trt == "Notch_EPF_FlashFreeze"] <- "Notch_EPF_Flash"
combined_data$Overall_Trt[combined_data$Overall_Trt == "Notch_Hemolymph_FlashFreeze"] <- "Notch_Hemo_Flash"
bubble_plot <- ggplot(combined_data, aes(x = percent_alive, y = mean_dna_conc,
size = mean_gel_score)) +
geom_point(alpha = 0.6, color = "steelblue") +
geom_text(aes(label = Overall_Trt), vjust = 4, hjust = 0.5, size = 3,
family = "serif") +
scale_size_continuous(name = "Mean Gel Score\n(DNA Quality)",
range = c(3, 15),
limits = c(1, 4),
breaks = c(1, 2, 3, 4)) +
labs(x = "Mean Lifespan (days)",
y = "Mean DNA Concentration (total ng)",
title = "Oyster Survival, DNA Quantity, and DNA Quality by Treatment") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 12, hjust= 0.5),
legend.position = "right", text=element_text(family="serif"))
bubble_plot
bubble_plot <- ggplot(combined_data, aes(x = percent_alive, y = mean_dna_conc,
size = mean_gel_score)) +
geom_point(alpha = 0.6, color = "steelblue") +
geom_text(aes(label = Overall_Trt), vjust = 4, hjust = 0.5, size = 3,
family = "serif") +
scale_size_continuous(name = "Mean Gel Score\n(DNA Quality)",
range = c(3, 15),
limits = c(1, 4),
breaks = c(1, 2, 3, 4)) +
labs(x = "Percent Alive at end of day 11",
y = "Mean DNA Concentration (total ng)",
title = "Comparing metrics by treatment") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 12, hjust= 0.5),
legend.position = "right", text=element_text(family="serif"))
bubble_plot
bubble_plot <- ggplot(combined_data, aes(x = percent_alive, y = mean_dna_conc,
size = mean_gel_score)) +
geom_point(alpha = 0.6, color = "steelblue") +
geom_text(aes(label = Overall_Trt), vjust = 4, hjust = 0.5, size = 3,
family = "serif") +
scale_size_continuous(name = "Mean Gel Score\n(DNA Quality)",
range = c(3, 8),
limits = c(1, 4),
breaks = c(1, 2, 3, 4)) +
labs(x = "Percent Alive at end of day 11",
y = "Mean DNA Concentration (total ng)",
title = "Comparing metrics by treatment") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 12, hjust= 0.5),
legend.position = "right", text=element_text(family="serif"))
bubble_plot
bubble_plot <- ggplot(combined_data, aes(x = percent_alive, y = mean_dna_conc,
size = mean_gel_score)) +
geom_point(alpha = 0.6, color = "steelblue") +
geom_text(aes(label = Overall_Trt), vjust = 4, hjust = 0.5, size = 3,
family = "serif") +
scale_size_continuous(name = "Mean Gel Score\n(DNA Quality)",
range = c(2, 8),
limits = c(1, 4),
breaks = c(1, 2, 3, 4)) +
labs(x = "Percent Alive at end of day 11",
y = "Mean DNA Concentration (total ng)",
title = "Comparing metrics by treatment") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 12, hjust= 0.5),
legend.position = "right", text=element_text(family="serif"))
bubble_plot
bubble_plot <- ggplot(combined_data, aes(x = percent_alive, y = mean_dna_conc,
size = mean_gel_score)) +
geom_point(alpha = 0.6, color = "steelblue") +
geom_text(aes(label = Overall_Trt), vjust = 4, hjust = 0.5, size = 3,
family = "serif") +
scale_size_continuous(name = "Mean Gel Score\n(DNA Quality)",
range = c(1, 8),
limits = c(1, 4),
breaks = c(1, 2, 3, 4)) +
labs(x = "Percent Alive at end of day 11",
y = "Mean DNA Concentration (total ng)",
title = "Comparing metrics by treatment") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 12, hjust= 0.5),
legend.position = "right", text=element_text(family="serif"))
bubble_plot
bubble_plot <- ggplot(combined_data, aes(x = percent_alive, y = mean_dna_conc,
color = mean_gel_score)) +
geom_point(size = 5, alpha = 0.7) +  # Fixed size for all points
geom_text(aes(label = Overall_Trt), vjust = 2, hjust = 0.5, size = 3,
family = "serif", color = "black") +
scale_y_continuous(limits = c(0, NA)) +
scale_x_continuous(limits = c(0, 100)) +
scale_color_gradient(name = "Mean Gel Score\n(DNA Quality)",
low = "lightblue", high = "darkblue",
limits = c(1, 4),
breaks = c(1, 2, 3, 4)) +
labs(x = "Percent Alive at End of Day 11",
y = "Mean DNA Concentration (total ng)",
title = "Comparing Metrics by Treatment") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 14, hjust = 0.5),
legend.position = "right",
text = element_text(family = "serif"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
print(bubble_plot)
bubble_plot <- ggplot(combined_data, aes(x = percent_alive, y = mean_dna_conc,
color = factor(round(mean_gel_score)))) +
geom_point(size = 5, alpha = 0.7) +  # Fixed size for all points
geom_text(aes(label = Overall_Trt), vjust = 2, hjust = 0.5, size = 3,
family = "serif", color = "black") +
scale_y_continuous(limits = c(0, NA)) +
scale_x_continuous(limits = c(0, 100)) +
scale_color_manual(name = "Mean Gel Score\n(DNA Quality)",
values = c("1" = "#fee5d9", "2" = "#fcae91",
"3" = "#fb6a4a", "4" = "#cb181d"),
breaks = c("1", "2", "3", "4")) +
labs(x = "Percent Alive at End of Day 11",
y = "Mean DNA Concentration (total ng)",
title = "Comparing Metrics by Treatment") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 14, hjust = 0.5),
legend.position = "right",
text = element_text(family = "serif"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
print(bubble_plot)
bubble_plot <- ggplot(combined_data, aes(x = percent_alive, y = mean_dna_conc,
color = factor(round(mean_gel_score)))) +
geom_point(size = 5, alpha = 0.7) +  # Fixed size for all points
geom_text(aes(label = Overall_Trt), vjust = 2, hjust = 0.5, size = 3,
family = "serif", color = "black") +
scale_y_continuous(limits = c(0, NA)) +
scale_x_continuous(limits = c(0, 100)) +
scale_color_manual(name = "Mean Gel Score\n(DNA Quality)",
values = c("1" = "#08519c", "2" = "#4292c6",
"3" = "#9ecae1", "4" = "#deebf7"),
breaks = c("1", "2", "3", "4")) +
labs(x = "Percent Alive at End of Day 11",
y = "Mean DNA Concentration (total ng)",
title = "Comparing Metrics by Treatment") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 14, hjust = 0.5),
legend.position = "right",
text = element_text(family = "serif"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
print(bubble_plot)
ggsave("Figure_3D_Bubble.png", bubble_plot, width = 10, height, dpi = 300)
bubble_plot <- ggplot(combined_data, aes(x = percent_alive, y = mean_dna_conc,
color = factor(round(mean_gel_score)))) +
geom_point(size = 5, alpha = 0.7) +  # Fixed size for all points
geom_text(aes(label = Overall_Trt), vjust = 2, hjust = 0.5, size = 3,
family = "serif", color = "black") +
scale_y_continuous(limits = c(0, NA)) +
scale_x_continuous(limits = c(0, 100)) +
scale_color_manual(name = "Mean Gel Score\n(DNA Quality)",
values = c("1" = "#08519c", "2" = "#4292c6",
"3" = "#9ecae1", "4" = "#deebf7"),
breaks = c("1", "2", "3", "4")) +
labs(x = "Percent Alive at End of Day 11",
y = "Mean DNA Concentration (total ng)",
title = "Comparing Metrics by Treatment") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 14, hjust = 0.5),
legend.position = "right",
text = element_text(family = "serif"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
print(bubble_plot)
ggsave("fig7_scatter.png", dpi = 300, width = 6, height = 4)
getwd()
setwd("~/Documents/NORTHEASTERN/LOTTERHOS/non_lethal_oysters")
ggsave("fig7_scatter.png", dpi = 300, width = 10, height = 4)
bubble_plot <- ggplot(combined_data, aes(x = percent_alive, y = mean_dna_conc,
color = factor(round(mean_gel_score)))) +
geom_point(size = 5, alpha = 0.7) +
geom_text_repel(aes(label = Overall_Trt), vjust = 2, hjust = 0.5, size = 3,
family = "serif", color = "black") +
scale_y_continuous(limits = c(0, NA)) +
scale_x_continuous(limits = c(0, 100)) +
scale_color_manual(name = "Mean Gel Score\n(DNA Quality)",
values = c("1" = "#08519c", "2" = "#4292c6",
"3" = "#9ecae1", "4" = "#deebf7"),
breaks = c("1", "2", "3", "4")) +
labs(x = "Percent Alive at End of Day 11",
y = "Mean DNA Concentration (total ng)",
title = "Comparing Metrics by Treatment") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 14, hjust = 0.5),
legend.position = "right",
text = element_text(family = "serif"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
# Load required libraries
library(tidyverse)
bubble_plot <- ggplot(combined_data, aes(x = percent_alive, y = mean_dna_conc,
color = factor(round(mean_gel_score)))) +
geom_point(size = 5, alpha = 0.7) +
geom_text_repel(aes(label = Overall_Trt), vjust = 2, hjust = 0.5, size = 3,
family = "serif", color = "black") +
scale_y_continuous(limits = c(0, NA)) +
scale_x_continuous(limits = c(0, 100)) +
scale_color_manual(name = "Mean Gel Score\n(DNA Quality)",
values = c("1" = "#08519c", "2" = "#4292c6",
"3" = "#9ecae1", "4" = "#deebf7"),
breaks = c("1", "2", "3", "4")) +
labs(x = "Percent Alive at End of Day 11",
y = "Mean DNA Concentration (total ng)",
title = "Comparing Metrics by Treatment") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 14, hjust = 0.5),
legend.position = "right",
text = element_text(family = "serif"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
library(ggrepel)
bubble_plot <- ggplot(combined_data, aes(x = percent_alive, y = mean_dna_conc,
color = factor(round(mean_gel_score)))) +
geom_point(size = 5, alpha = 0.7) +
geom_text_repel(aes(label = Overall_Trt), vjust = 2, hjust = 0.5, size = 3,
family = "serif", color = "black") +
scale_y_continuous(limits = c(0, NA)) +
scale_x_continuous(limits = c(0, 100)) +
scale_color_manual(name = "Mean Gel Score\n(DNA Quality)",
values = c("1" = "#08519c", "2" = "#4292c6",
"3" = "#9ecae1", "4" = "#deebf7"),
breaks = c("1", "2", "3", "4")) +
labs(x = "Percent Alive at End of Day 11",
y = "Mean DNA Concentration (total ng)",
title = "Comparing Metrics by Treatment") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 14, hjust = 0.5),
legend.position = "right",
text = element_text(family = "serif"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
print(bubble_plot)
ggplot(combined_data, aes(x = percent_alive, y = mean_dna_conc,
color = factor(round(mean_gel_score)))) +
geom_point(size = 5, alpha = 0.7) +
geom_text_repel(aes(label = Overall_Trt), vjust = 2, hjust = 0.5, size = 3,
family = "serif", color = "black") +
scale_y_continuous(limits = c(0, NA)) +
scale_x_continuous(limits = c(0, 100)) +
scale_color_manual(name = "Mean Gel Score\n(DNA Quality)",
values = c("1" = "#08519c", "2" = "#4292c6",
"3" = "#9ecae1", "4" = "#deebf7"),
breaks = c("1", "2", "3", "4")) +
labs(x = "Percent Alive at End of Trial",
y = "Mean DNA Concentration (total ng)",
title = "Comparing Metrics by Treatment") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 14, hjust = 0.5),
legend.position = "right",
text = element_text(family = "serif"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
ggsave("fig7_scatter.png", dpi = 300, width = 7, height = 4)
ggplot(combined_data, aes(x = percent_alive, y = mean_dna_conc,
color = factor(round(mean_gel_score)))) +
geom_point(size = 5, alpha = 0.7) +
geom_text_repel(aes(label = Overall_Trt), vjust = 2, hjust = 0.5, size = 3,
family = "serif", color = "black") +
scale_y_continuous(limits = c(0, NA)) +
scale_x_continuous(limits = c(0, 100)) +
scale_color_manual(name = "Mean Gel Score\n(DNA Quality)",
values = c("1" = "#08519c", "2" = "#4292c6",
"3" = "#9ecae1", "4" = "#deebf7"),
breaks = c("1", "2", "3", "4")) +
labs(x = "Percent Alive at End of Trial",
y = "Mean DNA Quantity (total ng)",
title = "Comparing Metrics by Treatment") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 14, hjust = 0.5),
legend.position = "right",
text = element_text(family = "serif"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
ggsave("fig7_scatter.png", dpi = 300, width = 7, height = 4)
all_island_pop <- read.csv("island_population_history.csv")
all_island_pop_long <- melt(all_island_pop, id.vars = "Year", variable.name = "Island", value.name = "Island_pop")
View(dna_aov)
library(reshape2)
library(reshape2)
all_island_pop <- read.csv("island_population_history.csv")
all_island_pop_long <- melt(all_island_pop, id.vars = "Year", variable.name = "Island", value.name = "Island_pop")
all_island_pop_long$Island <- as.character(all_island_pop_long$Island)
all_island_pop_long$Island[all_island_pop_long$Island == "Santa.Catalina"] <- "SCA"
all_island_pop_long$Island[all_island_pop_long$Island == "San.Clemente"] <- "SCI"
all_island_pop_long$Island[all_island_pop_long$Island == "San.Nicolas"] <- "SNI"
all_island_pop_long$Island[all_island_pop_long$Island == "Santa.Rosa"] <- "SRI"
all_island_pop_long$Island[all_island_pop_long$Island == "San.Miguel"] <- "SMI"
all_island_pop_long$Island[all_island_pop_long$Island == "Santa.Cruz"] <- "SCZ"
ggplot(all_island_pop_long, aes(x = Year, y = Island_pop, color = Island, group = Island)) +
geom_line(linewidth = 1) +
geom_point() +
geom_rect(aes(xmin=2000,xmax=2008,ymin=0,ymax=4200),fill="#b1c9ef", color = NA, alpha=.1) +
geom_rect(aes(xmin=1998,xmax=2000,ymin=0,ymax=4200),fill="#d5deef", color = NA, alpha=.1) +
geom_point(aes(x = 1999, y = 60, shape = "Golden Eagle Predation Starts"), size = 3, color = "#332288") +
scale_color_manual(values = c("#5C8148","#4AA022", "#9B9B7A", "#D08C60", "#997B66", "#B59E8A" ),
labels = c("San Clemente Island", "San Nicolas Island", "San Miguel Island", "Santa Rosa Island", "Santa Cruz Island", "Santa Catalina Island")) +
labs(title = "Island Fox Populations Over Time",
x = "Year",
y = "Population") +
theme_minimal() +
scale_shape_manual(name = NA, values = c("Golden Eagle Predation Starts" = 8)) +
theme(plot.title = element_text(hjust = 0.5), text = element_text(family = "Times"),
legend.title = element_text(hjust = 0.5))
ggsave("island_fox_pop_over_time.pdf",width = 10, height = 7)
island_colors <- c("SCA" = "#EE6677", "SCI" = "#4477AA", "SCZ" = "#CCBB44", "SMI" =  "#228833", "SNI" =  "#66ccEE", "SRI" =  "#AA3377")
all_island_pop_long$Island <- factor(
all_island_pop_long$Island,
levels = c("SMI", "SRI",
"SCZ", "SCI",
"SNI", "SCA"))
aggregate(Island_pop ~ Island, data = all_island_pop_long, FUN = max)
all_island_pop_long <- all_island_pop_long %>%
mutate(max_pop = case_when(
Island == "SCA" ~ 2372,
Island == "SCI" ~ 1200,
Island == "SRI" ~ 2833,
Island == "SMI" ~ 525,
Island == "SCZ" ~ 4057,
Island == "SNI" ~ 725,
TRUE ~ NA_real_))
all_island_pop_long$relative_pop <- all_island_pop_long$Island_pop/all_island_pop_long$max_pop
captive_breeding <- data.frame(
xmin = c(2001, 2001, 2001, 1999),
xmax = c(2007, 2008, 2007, 2006),
ymin = c(0, 0, 0, 0),
ymax = c(1, 1, 1, 1),
Island = c("SMI", "SRI", "SCZ", "SCA")
)
only_SCA_captive_breeding <- data.frame(
xmin = c( 1999),
xmax = c(2006),
ymin = c( 0),
ymax = c( 1),
Island = c("SCA")
)
golden_eagle <- data.frame(
xmin = 1994,
xmax = 2004,
ymin=0, ymax=1,
Island = c("SMI", "SRI", "SCZ"))
cdv_outbreak <- data.frame(
xintercept = 1999,
Island = "SCA"
)
all_island_pop_long$Island <- factor(
all_island_pop_long$Island,
levels = c("SMI", "SRI", "SCZ", "SCI", "SNI", "SCA")
)
captive_breeding$Island <- factor(
captive_breeding$Island,
levels = c("SMI", "SRI", "SCZ", "SCI", "SNI", "SCA")
)
only_SCA_captive_breeding$Island <- factor(
only_SCA_captive_breeding$Island,
levels = c("SMI", "SRI", "SCZ", "SCI", "SNI", "SCA")
)
golden_eagle$Island <- factor(
golden_eagle$Island,
levels = c("SMI", "SRI", "SCZ", "SCI", "SNI", "SCA")
)
cdv_outbreak$Island <- factor(
cdv_outbreak$Island,
levels = c("SMI", "SRI", "SCZ", "SCI", "SNI", "SCA")
)
ggplot(all_island_pop_long, aes(x = Year, y = relative_pop, color = Island)) +
geom_line(linewidth = 1) +
geom_point() +
scale_color_manual(values = island_colors) +
facet_grid(Island ~ .)  + theme_bw() + theme(legend.position="none",
strip.background=element_rect(colour="white",
fill="white")) +   geom_rect(data = captive_breeding,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "gray", alpha = 0.3, inherit.aes = FALSE) +
geom_rect(data = golden_eagle,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "orange", alpha = 0.3, inherit.aes = FALSE) +
geom_vline(data = cdv_outbreak,
aes(xintercept = xintercept),
linetype = "dashed", color = "black",
inherit.aes = FALSE) +  xlab("Island") + ylab("Population size relative to carrying capacity")
grey_colors <- c("SCA" = "#EE6677", "SCI" = "grey", "SCZ" = "grey", "SMI" =  "grey", "SNI" =   "#66ccEE", "SRI" =  "grey")
ggplot(all_island_pop_long, aes(x = Year, y = relative_pop, color = Island)) +
geom_line(linewidth = 1) +
geom_point() +
scale_color_manual(values = grey_colors) +
facet_grid(Island ~ .)  + theme_bw() + theme(legend.position="none",
strip.background=element_rect(colour="white",
fill="white"))  +
geom_rect(data = captive_breeding,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "gray", alpha = 0.3, inherit.aes = FALSE) +
geom_vline(data = cdv_outbreak,
aes(xintercept = xintercept),
linetype = "dashed", color = "black",
inherit.aes = FALSE) +
geom_rect(data = golden_eagle,
aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
fill = "grey", alpha = 0.3, inherit.aes = FALSE) +  xlab("Island") + ylab("Population size relative to carrying capacity")
ggsave("sca_sni_history.png", dpi=300, width=6, height=6)
ggplot(all_island_pop_long, aes(x = Year, y = Island_pop, color = Island, group = Island)) +
geom_line(linewidth = 1) +
geom_point() +
geom_rect(aes(xmin=2000,xmax=2008,ymin=0,ymax=4200),fill="#DDCC77", color = NA, alpha=0.02) +
geom_point(aes(x = 1999, y = 60, shape = "Golden Eagle Predation Starts"), size = 3, color = "#332288") +
labs(title = "Island Fox Populations Over Time",
x = "Year",
y = "Population") +
theme_minimal() +
scale_shape_manual(name = NA, values = c("Golden Eagle Predation Starts" = 8)) +
theme(plot.title = element_text(hjust = 0.5), text = element_text(family = "Times"),
legend.title = element_text(hjust = 0.5))
